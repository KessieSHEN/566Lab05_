<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab05_SiShen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lab05shen_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab05shen_files/libs/quarto-html/quarto.js"></script>
<script src="lab05shen_files/libs/quarto-html/popper.min.js"></script>
<script src="lab05shen_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab05shen_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab05shen_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab05shen_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab05shen_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab05shen_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab05shen_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="lab05shen_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="lab05shen_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="lab05shen_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="lab05shen_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="lab05shen_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="lab05shen_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="lab05shen_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="lab05shen_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="lab05shen_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="lab05shen_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab05_SiShen</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setup-in-r" class="level2">
<h2 class="anchored" data-anchor-id="setup-in-r">SetUp in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dtplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R.utils)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: R.oo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: R.methodsS3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.methodsS3 v1.8.2 (2022-06-13 22:00:14 UTC) successfully loaded. See ?R.methodsS3 for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.oo v1.26.0 (2024-01-24 05:12:50 UTC) successfully loaded. See ?R.oo for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'R.oo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:R.methodsS3':

    throw</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:methods':

    getClasses, getMethods</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    attach, detach, load, save</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R.utils v2.12.3 (2023-11-18 01:00:02 UTC) successfully loaded. See ?R.utils for help.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'R.utils'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    timestamp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    cat, commandArgs, getOption, isOpen, nullfile, parse, use, warnings</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
</div>
</section>
<section id="pre-process-the-stations-data" class="level2">
<h2 class="anchored" data-anchor-id="pre-process-the-stations-data">Pre-process the stations data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"met_all.gz"</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">"https://raw.githubusercontent.com/USCbiostats/data-science-data/master/02_met/met_all.gz"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="st">"met_all.gz"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method   =</span> <span class="st">"libcurl"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">timeout  =</span> <span class="dv">60</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">"met_all.gz"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"https://noaa-isd-pds.s3.amazonaws.com/isd-history.csv"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>stations[, USAF <span class="sc">:</span><span class="er">=</span> <span class="fu">as.integer</span>(USAF)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>stations[, USAF   <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(USAF <span class="sc">==</span> <span class="dv">999999</span>, <span class="cn">NA_integer_</span>, USAF)]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>stations[, CTRY   <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(CTRY <span class="sc">==</span> <span class="st">""</span>, <span class="cn">NA_character_</span>, CTRY)]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>stations[, STATE  <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(STATE <span class="sc">==</span> <span class="st">""</span>, <span class="cn">NA_character_</span>, STATE)]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">unique</span>(stations[, <span class="fu">list</span>(USAF, CTRY, STATE)])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> stations[<span class="sc">!</span><span class="fu">is.na</span>(USAF)]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>stations[, n <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span><span class="sc">:</span>.N, by <span class="ot">=</span> .(USAF)]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> stations[n <span class="sc">==</span> <span class="dv">1</span>,][, n <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Merge the data</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> met[, .(USAFID, WBAN, year, month, day, hour, min, lat, lon, elev, wind.sp, temp, atm.press)]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>metmerge <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x     =</span> met,      </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y     =</span> stations, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># List of variables to match</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.x  =</span> <span class="st">"USAFID"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.y  =</span> <span class="st">"USAF"</span>, </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Which obs to keep?</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,      </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metmerge[, <span class="fu">list</span>(USAFID, WBAN, STATE)], <span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;USAFID&gt;
   USAFID  WBAN  STATE
    &lt;int&gt; &lt;int&gt; &lt;char&gt;
1: 690150 93121     CA
2: 690150 93121     CA
3: 690150 93121     CA
4: 690150 93121     CA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metmerge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2377343      15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>metmerge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;USAFID&gt;
         USAFID  WBAN  year month   day  hour   min    lat      lon  elev
          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;num&gt;    &lt;num&gt; &lt;int&gt;
      1: 690150 93121  2019     8     1     0    56 34.300 -116.166   696
      2: 690150 93121  2019     8     1     1    56 34.300 -116.166   696
      3: 690150 93121  2019     8     1     2    56 34.300 -116.166   696
      4: 690150 93121  2019     8     1     3    56 34.300 -116.166   696
      5: 690150 93121  2019     8     1     4    56 34.300 -116.166   696
     ---                                                                 
2377339: 726813 94195  2019     8    31    19    56 43.650 -116.633   741
2377340: 726813 94195  2019     8    31    20    56 43.650 -116.633   741
2377341: 726813 94195  2019     8    31    21    56 43.650 -116.633   741
2377342: 726813 94195  2019     8    31    22    56 43.642 -116.636   741
2377343: 726813 94195  2019     8    31    23    56 43.642 -116.636   741
         wind.sp  temp atm.press   CTRY  STATE
           &lt;num&gt; &lt;num&gt;     &lt;num&gt; &lt;char&gt; &lt;char&gt;
      1:     5.7  37.2    1009.9     US     CA
      2:     8.2  35.6    1010.3     US     CA
      3:     6.7  34.4    1010.6     US     CA
      4:     5.1  33.3    1011.6     US     CA
      5:     2.1  32.8    1012.7     US     CA
     ---                                      
2377339:     2.1  32.2    1012.8     US     ID
2377340:     0.0  33.3    1011.6     US     ID
2377341:     2.6  35.0    1010.8     US     ID
2377342:     2.1  34.4    1010.1     US     ID
2377343:     2.1  34.4    1009.6     US     ID</code></pre>
</div>
</div>
</section>
<section id="question-1-representative-station-for-the-us" class="level2">
<h2 class="anchored" data-anchor-id="question-1-representative-station-for-the-us">Question 1: Representative station for the US</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>metbys <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(temp, wind.sp, atm.press, lat, lon, elev) <span class="sc">~</span> USAFID,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> metmerge,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> median, <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Look for the three weather stations that best represent continental US using the quantile() function.</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>quantiles_temp <span class="ot">&lt;-</span> <span class="fu">quantile</span>(metbys<span class="sc">$</span>temp, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>quantiles_wind <span class="ot">&lt;-</span> <span class="fu">quantile</span>(metbys<span class="sc">$</span>wind.sp, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>quantiles_pressure <span class="ot">&lt;-</span> <span class="fu">quantile</span>(metbys<span class="sc">$</span>atm.press, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Find stations for the median (50th percentile)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>median_station_temp <span class="ot">&lt;-</span> metbys[<span class="fu">which.min</span>(<span class="fu">abs</span>(metbys<span class="sc">$</span>temp <span class="sc">-</span> quantiles_temp[<span class="dv">2</span>])), ]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>median_station_wind <span class="ot">&lt;-</span> metbys[<span class="fu">which.min</span>(<span class="fu">abs</span>(metbys<span class="sc">$</span>wind.sp <span class="sc">-</span> quantiles_wind[<span class="dv">2</span>])), ]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>median_station_pressure <span class="ot">&lt;-</span> metbys[<span class="fu">which.min</span>(<span class="fu">abs</span>(metbys<span class="sc">$</span>atm.press <span class="sc">-</span> quantiles_pressure[<span class="dv">2</span>])), ]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(median_station_temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   USAFID temp wind.sp atm.press    lat    lon elev
19 720499 23.3     1.5    1015.4 36.783 -76.45    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(median_station_wind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   USAFID temp wind.sp atm.press    lat      lon elev
10 720369 17.8     2.6    1016.2 43.743 -111.097 1899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(median_station_pressure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   USAFID temp wind.sp atm.press  lat     lon elev
15 720394 26.1       0    1014.6 34.1 -93.066   56</code></pre>
</div>
</div>
</section>
<section id="question-2-representative-station-per-state" class="level2">
<h2 class="anchored" data-anchor-id="question-2-representative-station-per-state">Question 2: Representative station per state</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>state_medians <span class="ot">&lt;-</span> metmerge <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATE) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_temp =</span> <span class="fu">median</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_wind =</span> <span class="fu">median</span>(wind.sp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_pressure =</span> <span class="fu">median</span>(atm.press, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>  <span class="co"># Prevents group attributes from being retained</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Merge the medians back to the metmerge data</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>met_with_medians <span class="ot">&lt;-</span> metmerge <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(state_medians, <span class="at">by =</span> <span class="st">"STATE"</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate the Euclidean distance</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>met_with_medians <span class="ot">&lt;-</span> met_with_medians <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">euclidean_distance =</span> <span class="fu">sqrt</span>((temp <span class="sc">-</span> median_temp)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                              (wind.sp <span class="sc">-</span> median_wind)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                              (atm.press <span class="sc">-</span> median_pressure)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Find the closest station per state</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>repByState <span class="ot">&lt;-</span> met_with_medians <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATE) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(euclidean_distance, <span class="at">with_ties =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>  <span class="co"># Select the station with the smallest distance</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lat) <span class="sc">%&gt;%</span>  <span class="co"># Sort by latitude</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span>  <span class="co"># Select the station with the lowest latitude in case of ties</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STATE, USAFID, lat, lon, temp, wind.sp, atm.press, euclidean_distance)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame (if not already)</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>repByState <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(repByState)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(repByState)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   STATE USAFID    lat      lon temp wind.sp atm.press euclidean_distance
1     AL 722265 32.383  -86.350 25.3     1.5    1014.9          0.1000000
2     AR 723419 33.221  -92.814 25.6     2.1    1014.5          0.0000000
3     AZ 722730 31.583 -110.344 29.0     3.1    1010.7          0.1000000
4     CA 722903 32.816 -117.139 21.1     2.6    1012.8          0.0000000
5     CO 724665 39.275 -103.666 18.9     2.6    1013.6          0.1000000
6     CT 725027 41.510  -72.828 22.2     2.1    1015.2          0.0000000
7     DE 724180 39.674  -75.606 24.4     2.6    1015.4          0.0000000
8     FL 722210 30.483  -86.517 26.9     2.6    1015.1          0.1000000
9     GA 722175 32.633  -83.600 26.0     1.5    1014.9          0.0000000
10    IA 725470 42.398  -90.704 21.1     2.6    1014.9          0.1000000
11    ID 726810 43.567 -116.240 20.0     2.6    1013.0          0.5099020
12    IL 725430 42.193  -89.093 22.2     2.1    1014.7          0.1000000
13    IN 725335 40.650  -86.150 22.0     2.1    1014.6          0.2000000
14    KS 724520 37.284  -98.553 23.3     3.6    1013.6          0.1000000
15    KY 724240 37.900  -85.967 23.0     1.5    1015.3          0.0000000
16    LA 722400 30.125  -93.228 27.8     1.5    1014.6          0.0000000
17    MA 725065 41.676  -70.958 21.7     2.6    1015.0          0.1000000
18    MD 724060 39.173  -76.684 24.4     2.1    1015.6          0.3000000
19    ME 726083 47.286  -68.313 18.9     2.1    1014.1          0.0000000
20    MI 725386 44.022  -82.793 20.6     2.1    1014.3          0.1000000
21    MN 726440 43.904  -92.492 18.9     2.1    1014.9          0.2236068
22    MO 724450 38.817  -92.218 23.3     2.1    1014.8          0.0000000
23    MS 722358 31.183  -90.471 26.1     1.5    1014.9          0.1000000
24    MT 726770 45.800 -108.533 18.3     3.1    1014.5          0.2000000
25    NC 723066 35.344  -77.965 24.0     1.5    1015.8          0.1000000
26    ND 720491 46.217  -97.633 27.0     5.1        NA                 NA
27    NE 725555 41.433  -99.633 21.7     3.1    1014.3          0.0000000
28    NH 726164 44.368  -71.545 18.9     1.5    1014.8          0.2000000
29    NJ 724096 40.016  -74.592 23.3     1.5    1015.1          0.0000000
30    NM 723600 36.449 -103.153 24.4     3.1    1012.0          0.0000000
31    NV 725825 40.829 -115.788 26.7     2.6    1011.8          0.3000000
32    NY 726228 44.385  -74.207 20.6     2.1    1014.9          0.0000000
33    OH 724290 39.867  -84.117 21.7     2.6    1015.0          0.0000000
34    OK 723544 35.534  -97.647 26.7     3.1    1012.8          0.0000000
35    OR 720365 42.070 -124.290 17.2     2.1    1015.5          0.1000000
36    PA 725116 40.120  -76.294 21.1     1.5    1015.6          0.0000000
37    RI 725079 41.533  -71.283 22.2     2.6    1014.1          0.1000000
38    SC 723106 34.188  -79.731 25.0     1.5    1015.3          0.0000000
39    SD 726519 45.669  -96.991 20.0     3.6    1014.1          0.2000000
40    TN 723340 35.050  -90.000 23.9     1.5    1014.9          0.1000000
41    TX 722536 29.533  -98.262 29.0     3.1    1012.6          0.0000000
42    UT 725720 40.778 -111.969 26.1     4.1    1012.2          0.1000000
43    VA 724035 38.504  -77.305 23.3     1.5    1015.2          0.1000000
44    VT 725165 43.533  -72.950 18.9     1.5    1014.5          0.0000000
45    WA 720254 46.677 -122.983 17.0     0.0        NA                 NA
46    WI 726424 42.761  -87.814 18.9     2.1    1014.6          0.3000000
47    WV 724176 39.643  -79.916 21.1     1.5    1015.9          0.2000000
48    WY 725690 42.898 -106.473 18.3     3.6    1014.1          0.1000000</code></pre>
</div>
</div>
</section>
<section id="question-3-in-the-middle" class="level2">
<h2 class="anchored" data-anchor-id="question-3-in-the-middle">Question 3: In the middle?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>state_midpoints <span class="ot">&lt;-</span> metmerge <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATE) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid_lat =</span> <span class="fu">mean</span>(lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid_lon =</span> <span class="fu">mean</span>(lon, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>closest_stations <span class="ot">&lt;-</span> metmerge <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(state_midpoints, <span class="at">by =</span> <span class="st">"STATE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance_to_midpoint =</span> <span class="fu">sqrt</span>((lat <span class="sc">-</span> mid_lat)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (lon <span class="sc">-</span> mid_lon)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATE) <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(distance_to_midpoint, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STATE, USAFID, lat, lon, temp, wind.sp, atm.press)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>combined_stations <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(repByState, closest_stations)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>combined_stations <span class="ot">&lt;-</span> combined_stations <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>      USAFID <span class="sc">%in%</span> repByState<span class="sc">$</span>USAFID <span class="sc">~</span> <span class="st">"Representative Station"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>      USAFID <span class="sc">%in%</span> closest_stations<span class="sc">$</span>USAFID <span class="sc">~</span> <span class="st">"Closest to Midpoint"</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(combined_stations) <span class="sc">%&gt;%</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>lon, <span class="at">lat =</span> <span class="sc">~</span>lat,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span><span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">"Representative Station"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"State:"</span>, STATE, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"USAFID:"</span>, USAFID, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Temp:"</span>, temp, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Wind Speed:"</span>, wind.sp, <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Pressure:"</span>, atm.press),</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="sc">~</span>group</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="st">"bottomright"</span>, <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), </span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Representative Station"</span>, <span class="st">"Closest to Midpoint"</span>),</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Station Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="sc">-</span><span class="fl">98.5833</span>, <span class="at">lat =</span> <span class="fl">39.8333</span>, <span class="at">zoom =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-fca994cdb845d4523af3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fca994cdb845d4523af3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[32.383,33.221,31.583,32.816,39.275,41.51,39.674,30.483,32.633,42.398,43.567,42.193,40.65,37.284,37.9,30.125,41.676,39.173,47.286,44.022,43.904,38.817,31.183,45.8,35.344,46.217,41.433,44.368,40.016,36.449,40.829,44.385,39.867,35.534,42.07,40.12,41.533,34.188,45.669,35.05,29.533,40.778,38.504,43.533,46.677,42.761,39.643,42.898,33.177,35.259,34.257,36.767,39.05,41.51,39.133,28.474,32.64,41.691,44.89,40.477,40.711,38.066,37.578,30.718,41.876,38.981,44.533,43.322,45.147,38.096,32.321,45.808,35.582,48.39,40.967,43.567,40.033,35,38.06,42.209,40.28,35.417,42.6,40.849,41.597,33.921,44.381,36.009,31.106,40.219,37.358,44.204,47.104,44.36,39,43.067],[-86.34999999999999,-92.81399999999999,-110.344,-117.139,-103.666,-72.828,-75.60599999999999,-86.517,-83.59999999999999,-90.70399999999999,-116.24,-89.093,-86.15000000000001,-98.553,-85.967,-93.22799999999999,-70.958,-76.684,-68.313,-82.79300000000001,-92.492,-92.218,-90.471,-108.533,-77.965,-97.633,-99.633,-71.545,-74.592,-103.153,-115.788,-74.20699999999999,-84.117,-97.64700000000001,-124.29,-76.294,-71.283,-79.73099999999999,-96.991,-90,-98.262,-111.969,-77.30500000000001,-72.95,-122.983,-87.81399999999999,-79.916,-106.473,-86.783,-93.093,-111.339,-119.717,-105.516,-72.828,-75.467,-82.45399999999999,-83.592,-93.566,-116.101,-88.916,-86.375,-97.861,-84.77,-91.479,-71.021,-76.922,-69.667,-84.688,-94.50700000000001,-92.553,-90.078,-108.543,-79.101,-100.024,-98.31699999999999,-71.43300000000001,-74.35299999999999,-105.67,-117.087,-75.98,-83.11499999999999,-97.383,-123.364,-77.849,-71.41200000000001,-80.801,-100.285,-86.52,-98.196,-111.723,-78.438,-72.562,-122.287,-89.839,-80.274,-108.45],5,null,["Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Representative Station","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Representative Station","Closest to Midpoint","Closest to Midpoint","Representative Station","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Representative Station","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint","Closest to Midpoint"],{"interactive":true,"className":"","stroke":true,"color":["blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","red","red","red","red","blue","red","red","blue","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","red","red","red","red","blue","red","red","blue","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red"],"fillOpacity":0.2},null,null,null,null,["State: AL &lt;br&gt; USAFID: 722265 &lt;br&gt; Temp: 25.3 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.9","State: AR &lt;br&gt; USAFID: 723419 &lt;br&gt; Temp: 25.6 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.5","State: AZ &lt;br&gt; USAFID: 722730 &lt;br&gt; Temp: 29 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1010.7","State: CA &lt;br&gt; USAFID: 722903 &lt;br&gt; Temp: 21.1 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1012.8","State: CO &lt;br&gt; USAFID: 724665 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1013.6","State: CT &lt;br&gt; USAFID: 725027 &lt;br&gt; Temp: 22.2 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1015.2","State: DE &lt;br&gt; USAFID: 724180 &lt;br&gt; Temp: 24.4 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1015.4","State: FL &lt;br&gt; USAFID: 722210 &lt;br&gt; Temp: 26.9 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1015.1","State: GA &lt;br&gt; USAFID: 722175 &lt;br&gt; Temp: 26 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.9","State: IA &lt;br&gt; USAFID: 725470 &lt;br&gt; Temp: 21.1 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1014.9","State: ID &lt;br&gt; USAFID: 726810 &lt;br&gt; Temp: 20 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1013","State: IL &lt;br&gt; USAFID: 725430 &lt;br&gt; Temp: 22.2 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.7","State: IN &lt;br&gt; USAFID: 725335 &lt;br&gt; Temp: 22 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.6","State: KS &lt;br&gt; USAFID: 724520 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: 1013.6","State: KY &lt;br&gt; USAFID: 724240 &lt;br&gt; Temp: 23 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.3","State: LA &lt;br&gt; USAFID: 722400 &lt;br&gt; Temp: 27.8 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.6","State: MA &lt;br&gt; USAFID: 725065 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1015","State: MD &lt;br&gt; USAFID: 724060 &lt;br&gt; Temp: 24.4 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1015.6","State: ME &lt;br&gt; USAFID: 726083 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.1","State: MI &lt;br&gt; USAFID: 725386 &lt;br&gt; Temp: 20.6 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.3","State: MN &lt;br&gt; USAFID: 726440 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.9","State: MO &lt;br&gt; USAFID: 724450 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.8","State: MS &lt;br&gt; USAFID: 722358 &lt;br&gt; Temp: 26.1 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.9","State: MT &lt;br&gt; USAFID: 726770 &lt;br&gt; Temp: 18.3 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1014.5","State: NC &lt;br&gt; USAFID: 723066 &lt;br&gt; Temp: 24 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.8","State: ND &lt;br&gt; USAFID: 720491 &lt;br&gt; Temp: 27 &lt;br&gt; Wind Speed: 5.1 &lt;br&gt; Pressure: NA","State: NE &lt;br&gt; USAFID: 725555 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1014.3","State: NH &lt;br&gt; USAFID: 726164 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.8","State: NJ &lt;br&gt; USAFID: 724096 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.1","State: NM &lt;br&gt; USAFID: 723600 &lt;br&gt; Temp: 24.4 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1012","State: NV &lt;br&gt; USAFID: 725825 &lt;br&gt; Temp: 26.7 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1011.8","State: NY &lt;br&gt; USAFID: 726228 &lt;br&gt; Temp: 20.6 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.9","State: OH &lt;br&gt; USAFID: 724290 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1015","State: OK &lt;br&gt; USAFID: 723544 &lt;br&gt; Temp: 26.7 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1012.8","State: OR &lt;br&gt; USAFID: 720365 &lt;br&gt; Temp: 17.2 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1015.5","State: PA &lt;br&gt; USAFID: 725116 &lt;br&gt; Temp: 21.1 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.6","State: RI &lt;br&gt; USAFID: 725079 &lt;br&gt; Temp: 22.2 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1014.1","State: SC &lt;br&gt; USAFID: 723106 &lt;br&gt; Temp: 25 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.3","State: SD &lt;br&gt; USAFID: 726519 &lt;br&gt; Temp: 20 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: 1014.1","State: TN &lt;br&gt; USAFID: 723340 &lt;br&gt; Temp: 23.9 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.9","State: TX &lt;br&gt; USAFID: 722536 &lt;br&gt; Temp: 29 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1012.6","State: UT &lt;br&gt; USAFID: 725720 &lt;br&gt; Temp: 26.1 &lt;br&gt; Wind Speed: 4.1 &lt;br&gt; Pressure: 1012.2","State: VA &lt;br&gt; USAFID: 724035 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.2","State: VT &lt;br&gt; USAFID: 725165 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.5","State: WA &lt;br&gt; USAFID: 720254 &lt;br&gt; Temp: 17 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: WI &lt;br&gt; USAFID: 726424 &lt;br&gt; Temp: 18.9 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1014.6","State: WV &lt;br&gt; USAFID: 724176 &lt;br&gt; Temp: 21.1 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1015.9","State: WY &lt;br&gt; USAFID: 725690 &lt;br&gt; Temp: 18.3 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: 1014.1","State: AL &lt;br&gt; USAFID: 722300 &lt;br&gt; Temp: 32.2 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1011.5","State: AR &lt;br&gt; USAFID: 723429 &lt;br&gt; Temp: 30 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: 1009.2","State: AZ &lt;br&gt; USAFID: 723745 &lt;br&gt; Temp: 26 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: CA &lt;br&gt; USAFID: 723890 &lt;br&gt; Temp: 36.7 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1010.3","State: CO &lt;br&gt; USAFID: 726396 &lt;br&gt; Temp: 13 &lt;br&gt; Wind Speed: 4.6 &lt;br&gt; Pressure: NA","State: CT &lt;br&gt; USAFID: 725027 &lt;br&gt; Temp: 21.1 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: 1016.5","State: DE &lt;br&gt; USAFID: 724088 &lt;br&gt; Temp: 26 &lt;br&gt; Wind Speed: 5.1 &lt;br&gt; Pressure: 1016.5","State: FL &lt;br&gt; USAFID: 722014 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 6.2 &lt;br&gt; Pressure: 1018","State: GA &lt;br&gt; USAFID: 722175 &lt;br&gt; Temp: NA &lt;br&gt; Wind Speed: NA &lt;br&gt; Pressure: NA","State: IA &lt;br&gt; USAFID: 725466 &lt;br&gt; Temp: 19 &lt;br&gt; Wind Speed: NA &lt;br&gt; Pressure: NA","State: ID &lt;br&gt; USAFID: 725864 &lt;br&gt; Temp: NA &lt;br&gt; Wind Speed: NA &lt;br&gt; Pressure: NA","State: IL &lt;br&gt; USAFID: 724397 &lt;br&gt; Temp: 17.8 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: 1015.3","State: IN &lt;br&gt; USAFID: 720961 &lt;br&gt; Temp: 22 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: NA","State: KS &lt;br&gt; USAFID: 724506 &lt;br&gt; Temp: 31.7 &lt;br&gt; Wind Speed: 4.1 &lt;br&gt; Pressure: 1008","State: KY &lt;br&gt; USAFID: 720448 &lt;br&gt; Temp: 26 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: LA &lt;br&gt; USAFID: 720967 &lt;br&gt; Temp: 28 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: NA","State: MA &lt;br&gt; USAFID: 725068 &lt;br&gt; Temp: 23.3 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: 1016.3","State: MD &lt;br&gt; USAFID: 722244 &lt;br&gt; Temp: 26.4 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: ME &lt;br&gt; USAFID: 726073 &lt;br&gt; Temp: 24 &lt;br&gt; Wind Speed: 6.2 &lt;br&gt; Pressure: NA","State: MI &lt;br&gt; USAFID: 725405 &lt;br&gt; Temp: 22.7 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: NA","State: MN &lt;br&gt; USAFID: 726583 &lt;br&gt; Temp: 26 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: NA","State: MO &lt;br&gt; USAFID: 724459 &lt;br&gt; Temp: 22.2 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1018.4","State: MS &lt;br&gt; USAFID: 722350 &lt;br&gt; Temp: 22.8 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: NA","State: MT &lt;br&gt; USAFID: 726770 &lt;br&gt; Temp: 32.8 &lt;br&gt; Wind Speed: 4.1 &lt;br&gt; Pressure: 1012","State: NC &lt;br&gt; USAFID: 722201 &lt;br&gt; Temp: 24.5 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: ND &lt;br&gt; USAFID: 720867 &lt;br&gt; Temp: 29 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: NA","State: NE &lt;br&gt; USAFID: 725520 &lt;br&gt; Temp: 28.3 &lt;br&gt; Wind Speed: 5.1 &lt;br&gt; Pressure: 1015.2","State: NH &lt;br&gt; USAFID: 726155 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1016.2","State: NJ &lt;br&gt; USAFID: 724090 &lt;br&gt; Temp: 26.1 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: 1013.6","State: NM &lt;br&gt; USAFID: 722677 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1015.7","State: NV &lt;br&gt; USAFID: 724855 &lt;br&gt; Temp: 22.2 &lt;br&gt; Wind Speed: 2.1 &lt;br&gt; Pressure: 1013.2","State: NY &lt;br&gt; USAFID: 725150 &lt;br&gt; Temp: 21.7 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: 1011.7","State: OH &lt;br&gt; USAFID: 720928 &lt;br&gt; Temp: 25 &lt;br&gt; Wind Speed: 3.1 &lt;br&gt; Pressure: NA","State: OK &lt;br&gt; USAFID: 723540 &lt;br&gt; Temp: 32.3 &lt;br&gt; Wind Speed: 3.6 &lt;br&gt; Pressure: NA","State: OR &lt;br&gt; USAFID: 725975 &lt;br&gt; Temp: 25 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1014.1","State: PA &lt;br&gt; USAFID: 725128 &lt;br&gt; Temp: 17.8 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: RI &lt;br&gt; USAFID: 725074 &lt;br&gt; Temp: 25 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: SC &lt;br&gt; USAFID: 723105 &lt;br&gt; Temp: 20.1 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: SD &lt;br&gt; USAFID: 726560 &lt;br&gt; Temp: 26.1 &lt;br&gt; Wind Speed: 6.2 &lt;br&gt; Pressure: 1013.7","State: TN &lt;br&gt; USAFID: 723273 &lt;br&gt; Temp: 29 &lt;br&gt; Wind Speed: 2.6 &lt;br&gt; Pressure: NA","State: TX &lt;br&gt; USAFID: 720647 &lt;br&gt; Temp: 35.6 &lt;br&gt; Wind Speed: 4.1 &lt;br&gt; Pressure: NA","State: UT &lt;br&gt; USAFID: 725724 &lt;br&gt; Temp: 19.4 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: 1017.7","State: VA &lt;br&gt; USAFID: 724017 &lt;br&gt; Temp: 19.9 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: VT &lt;br&gt; USAFID: 726145 &lt;br&gt; Temp: 19.4 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: WA &lt;br&gt; USAFID: 720388 &lt;br&gt; Temp: 29 &lt;br&gt; Wind Speed: 0 &lt;br&gt; Pressure: NA","State: WI &lt;br&gt; USAFID: 726452 &lt;br&gt; Temp: 17.2 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: 1023.9","State: WV &lt;br&gt; USAFID: 720328 &lt;br&gt; Temp: 22 &lt;br&gt; Wind Speed: 1.5 &lt;br&gt; Pressure: NA","State: WY &lt;br&gt; USAFID: 726720 &lt;br&gt; Temp: 27.2 &lt;br&gt; Wind Speed: 5.7 &lt;br&gt; Pressure: 1014.8"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["blue","red"],"labels":["Representative Station","Closest to Midpoint"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":"Station Type","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[28.474,48.39],"lng":[-124.29,-68.313]},"setView":[[39.8333,-98.58329999999999],4,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="question-4-means-of-means" class="level2">
<h2 class="anchored" data-anchor-id="question-4-means-of-means">Question 4: Means of means</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>avg_temp_by_state <span class="ot">&lt;-</span> metmerge <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATE) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp =</span> <span class="fu">mean</span>(temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_entries =</span> <span class="fu">n</span>(),  </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_na_entries =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(temp)),  </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_stations =</span> <span class="fu">n_distinct</span>(USAFID),  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>avg_temp_by_state <span class="ot">&lt;-</span> avg_temp_by_state <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_level =</span> <span class="fu">case_when</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>      avg_temp <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>      avg_temp <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> avg_temp <span class="sc">&lt;</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Mid"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>      avg_temp <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> avg_temp_by_state <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_level) <span class="sc">%&gt;%</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_states =</span> <span class="fu">n</span>(),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_entries =</span> <span class="fu">sum</span>(num_entries),  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_na_entries =</span> <span class="fu">sum</span>(num_na_entries),  </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_stations =</span> <span class="fu">sum</span>(num_stations),  </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_temp =</span> <span class="fu">mean</span>(avg_temp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_wind_speed =</span> <span class="fu">mean</span>(metmerge<span class="sc">$</span>wind.sp[metmerge<span class="sc">$</span>STATE <span class="sc">%in%</span> avg_temp_by_state<span class="sc">$</span>STATE[avg_temp_by_state<span class="sc">$</span>temp_level <span class="sc">==</span> temp_level]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_atm_pressure =</span> <span class="fu">mean</span>(metmerge<span class="sc">$</span>atm.press[metmerge<span class="sc">$</span>STATE <span class="sc">%in%</span> avg_temp_by_state<span class="sc">$</span>STATE[avg_temp_by_state<span class="sc">$</span>temp_level <span class="sc">==</span> temp_level]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 4 warnings in `summarise()`.
The first warning was:
ℹ In argument: `mean_wind_speed = mean(...)`.
ℹ In group 2: `temp_level = "Low"`.
Caused by warning in `avg_temp_by_state$temp_level == temp_level`:
! longer object length is not a multiple of shorter object length
ℹ Run `dplyr::last_dplyr_warnings()` to see the 3 remaining warnings.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  temp_level num_states total_entries total_na_entries total_stations mean_temp
  &lt;chr&gt;           &lt;int&gt;         &lt;int&gt;            &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;
1 High               12        811126            23468            555      27.0
2 Low                11        430794             7369            259      18.7
3 Mid                25       1135423            29252            781      22.6
# ℹ 2 more variables: mean_wind_speed &lt;dbl&gt;, mean_atm_pressure &lt;dbl&gt;</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
<script>window.backupDefine = window.define; window.define = undefined;</script>
<script type="text/javascript" src="quarto-preview.js"></script>
<script>window.define = window.backupDefine; window.backupDefine = undefined;</script>
<script type="text/javascript">
  const options = {
    origin: "",
    search: "",
    inputFile: "/Users/ckkkkkkkj/Documents/PM566lab05-SHEN/lab05shen.qmd",
    isPresentation: false
  }
  document.addEventListener("DOMContentLoaded", function () {
    window.QuartoPreview.init(options);
  });
</script>
